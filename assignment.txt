use mysql;
create database training21;
use training21;

--1)LIST ALL MANAGER DATA--
   select MGR from emp;

--2)LIST EMP WHO ARE WORKING AS MANAGER OR ANALYST OR CLERK
   select * from emp where job IN ('MANAGER','CLERK','ANALYST');

--3)LIST EMP WHO ARE EARNING SAL BETWEEN 3000 AND 5000 (INCLUSIVE OF LIMIT)
   select * from emp  where SAL BETWEEN 3000 AND 5000;
     
--4)LIST EMP WHO ARE WORKING AS MANAGER OR ANALYST OR CLERK AND EARNING SAL BETWEEN 3000 AND 5000
    select * from emp where JOB IN ('CLERK','MANAGER','ANALYST' )AND SAL BETWEEN 3000 AND 5000;

--5)LIST ALL EMP WHO ARE EARNING COMM
	select * from emp where COMM >0;
   
--6)LIST ALL EMP WHOSE COMM IS NOT NULL
	select * from emp where COMM IS NOT NULL;
     
--7)LIST ALL EMP WHOSE NAME STARTS WITH S
    select * from emp where ENAME LIKE 'S%'
 
--8)LIST ALL EMP WHOSE NAME ENDS WITH R
	select * from emp where ENAME LIKE '%R'
 
--9)LIST ALL EMP WHOSE NAME CONTAINS A
    select * from emp where ENAME LIKE '_A%'
    
--10)LIST ALL EMP WHOSE NAME CONTAINS A AS SECOND LETTER
     select * from emp where ENAME LIKE '_A%'
     
--11)LIST ALL EMP WHOSE NAME STARTS WITH EITHER M OR S
     select * from emp where ENAME LIKE 'M%' OR ENAME LIKE 's%'
     
--12)LIST ALL EMP WHOSE NAME STARTS BETWEEN A TO M
	 select * from emp where ENAME REGEXP '^[A-M]';

--13)LIST ALL EMP WHOSE NAME CONTAINS _
    select * from emp where ENAME REGEXP '_';
    
--14)LIST ALL EMP WHO ARE WORKING AS MANAGER IN EITHER DEPT 10 OR 20 AND ALL CLERK FOR DEPT3 30
	select * from emp where job = 'MANAGER' AND deptno IN (10,20) OR job = 'CLERK' AND deptno = 30;
      
--15)LIST ENAME, SAL AND BONUS AS 10% OF SALARY
     select ENAME , SAL , (SAL*10/100) as Bonus from emp;
     
--16)LIST EMP DATA AS PER THE ASCENDING ORDER OF NAME
     select * from emp  order by ENAME;
     
--17)LIST ALL AS PER THEIR SALARY HIGHES TO LOWEST
     select * from emp  ORDER BY  SAL DESC;
     
--18)LIST EMP AS PER THEIR DEPT, WITH IN DEPT HIGHEST TO LOWESET SAL
     select * from emp  ORDER BY deptno , SAL DESC;
 
--19)list top 3 highest paid emp
     select * from EMP ORDER BY SAL DESC LIMIT 3;
     
--20)RETURN SEQUENTIAL NUMBER RETURN RANK BASED ON SPECIFED CRITERIA IF TWO EMP HAVE SAME SALARY THEY BOTH GET SAME NUMBER AND NEXT NUMBER WILL BE SKIPPED
     select EMPNO,ENAME,DEPTNO,SAL, RANK() OVER(partition by DEPTNO ORDER BY SAL DESC) AS 'RANK' FROM emp;

--21) RETURN CONSECUTIVE RANKING VALUES BASED ON A SPECIFIED CRITERIA
	select  EMPNO,ENAME,DEPTNO,SAL, DENSE_RANK() OVER(partition by deptno ORDER BY SAL DESC) AS 'RANK' FROM emp;
    
--22)LIST THE DIFFERNT JOB NAME
     select JOB from emp GROUP BY JOB;
     
--23)LIST TOTAL ORGANIZATION SALARY
     select SUM(SAL) AS TOTAL_ORG_SAL from emp;
     
--24)LIST DEPTWISE TOTAL SALARY
     select DEPTNO,SUM(SAL) AS TOTAL_DEPT_SAL from emp GROUP BY DEPTNO;
     
--25)LIST JOBWISE EMP COUNT.
     select JOB,COUNT(*) AS EMP_COUNT from emp GROUP BY JOB;
     
--26)LIST ALL EMP WHO HAVE JOINED IN MONTH OF FEB
     select * from emp where MONTH(HIREDATE) = 2;
     
--27)LIST EMP COUNT   JOINED BETWEEN 1981 AND 1983
  select COUNT(*) AS EMP_COUNT from emp where HIREDATE BETWEEN '1981-01-01' AND '1983-12-31';

--28)LIST HOW MANY YEARS OF SERVICE COMPLETED BY EACH EMP ARRANGE BASED ON TENURE HIGHEST TO LOWEST
     select ENAME, YEAR(NOW())-YEAR(HIREDATE) AS 'TENURE' from emp ORDER BY TENURE DESC;
